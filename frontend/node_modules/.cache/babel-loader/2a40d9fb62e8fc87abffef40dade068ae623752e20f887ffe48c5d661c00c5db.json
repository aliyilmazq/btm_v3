{"ast":null,"code":"import _objectSpread from\"/Users/aliyilmaz/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState}from\"react\";import StratejiPerformansOzeti from\"./StratejiPerformansOzeti\";import MessageBox from\"./MessageBox\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Step3AnalizSonuc(_ref){let{formData,onBack}=_ref;const[sonuc,setSonuc]=useState(null);const[error,setError]=useState(\"\");const[loading,setLoading]=useState(false);const[message,setMessage]=useState({type:\"info\",text:\"\"});const[log,setLog]=useState([]);const appendLog=msg=>setLog(prev=>[...prev,msg]);const handleAnalyze=()=>{setLoading(true);setError(\"\");setSonuc(null);setMessage({type:\"info\",text:\"Analiz başlatıldı, lütfen bekleyin...\"});setLog([]);appendLog(\"[INFO] /analyze endpoint'ine istek gönderiliyor...\");appendLog(\"[PAYLOAD] \".concat(JSON.stringify(formData)));fetch(\"/analyze\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(formData)}).then(async res=>{appendLog(\"[RESPONSE] Status: \".concat(res.status));const data=await res.json();appendLog(\"[RESPONSE BODY] \".concat(JSON.stringify(data)));if(data.status===\"success\"){setSonuc(data.rapor);setMessage({type:\"success\",text:\"Analiz tamamlandı, rapor hazır!\"});}else{setError(data.error||\"Bilinmeyen bir hata oluştu.\");setMessage({type:\"error\",text:data.error||\"Bilinmeyen bir hata oluştu.\"});}setLoading(false);// Backend loglarını çek\nfetch(\"/logs\").then(res=>res.json()).then(logData=>{appendLog(\"[BACKEND LOG - Son 50 Satır]\");(logData.lines||[]).forEach(line=>appendLog(line.trim()));});}).catch(e=>{setError(\"Sunucuya ulaşılamadı.\");setMessage({type:\"error\",text:\"Sunucuya ulaşılamadı.\"});appendLog(\"[ERROR] \".concat(e&&e.message?e.message:e));setLoading(false);});};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Analiz ve Sonu\\xE7\"}),/*#__PURE__*/_jsx(MessageBox,{type:message.type,message:message.text,onClose:()=>setMessage(_objectSpread(_objectSpread({},message),{},{text:\"\"}))}),/*#__PURE__*/_jsxs(\"div\",{style:{background:'#f5f5f5',borderRadius:8,padding:'12px 16px',margin:'12px 0 18px 0',fontSize:14,maxHeight:260,overflowY:'auto'},children:[/*#__PURE__*/_jsx(\"b\",{children:\"Analiz G\\xFCnl\\xFC\\u011F\\xFC\"}),/*#__PURE__*/_jsx(\"pre\",{style:{whiteSpace:'pre-wrap',margin:0},children:log.join(\"\\n\")})]}),/*#__PURE__*/_jsx(\"button\",{className:\"modern-btn\",onClick:onBack,children:\"Geri D\\xF6n\"}),/*#__PURE__*/_jsx(\"button\",{className:\"modern-btn\",onClick:handleAnalyze,disabled:loading,style:{marginLeft:8},children:\"Analiz Et\"}),loading&&/*#__PURE__*/_jsx(\"div\",{className:\"info-message\",children:\"Analiz yap\\u0131l\\u0131yor, l\\xFCtfen bekleyin...\"}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"error-message\",children:error}),sonuc&&/*#__PURE__*/_jsx(\"div\",{style:{marginTop:24},children:/*#__PURE__*/_jsx(StratejiPerformansOzeti,{sonuc:sonuc})})]});}export default Step3AnalizSonuc;","map":{"version":3,"names":["React","useState","StratejiPerformansOzeti","MessageBox","jsx","_jsx","jsxs","_jsxs","Step3AnalizSonuc","_ref","formData","onBack","sonuc","setSonuc","error","setError","loading","setLoading","message","setMessage","type","text","log","setLog","appendLog","msg","prev","handleAnalyze","concat","JSON","stringify","fetch","method","headers","body","then","res","status","data","json","rapor","logData","lines","forEach","line","trim","catch","e","children","onClose","_objectSpread","style","background","borderRadius","padding","margin","fontSize","maxHeight","overflowY","whiteSpace","join","className","onClick","disabled","marginLeft","marginTop"],"sources":["/Users/aliyilmaz/Documents/GitHub/btm_v3/frontend/src/components/Step3AnalizSonuc.js"],"sourcesContent":["import React, { useState } from \"react\";\nimport StratejiPerformansOzeti from \"./StratejiPerformansOzeti\";\nimport MessageBox from \"./MessageBox\";\n\nfunction Step3AnalizSonuc({ formData, onBack }) {\n  const [sonuc, setSonuc] = useState(null);\n  const [error, setError] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const [message, setMessage] = useState({ type: \"info\", text: \"\" });\n  const [log, setLog] = useState([]);\n\n  const appendLog = (msg) => setLog((prev) => [...prev, msg]);\n\n  const handleAnalyze = () => {\n    setLoading(true);\n    setError(\"\");\n    setSonuc(null);\n    setMessage({ type: \"info\", text: \"Analiz başlatıldı, lütfen bekleyin...\" });\n    setLog([]);\n    appendLog(\"[INFO] /analyze endpoint'ine istek gönderiliyor...\");\n    appendLog(`[PAYLOAD] ${JSON.stringify(formData)}`);\n    fetch(\"/analyze\", {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify(formData)\n    })\n      .then(async res => {\n        appendLog(`[RESPONSE] Status: ${res.status}`);\n        const data = await res.json();\n        appendLog(`[RESPONSE BODY] ${JSON.stringify(data)}`);\n        if (data.status === \"success\") {\n          setSonuc(data.rapor);\n          setMessage({ type: \"success\", text: \"Analiz tamamlandı, rapor hazır!\" });\n        } else {\n          setError(data.error || \"Bilinmeyen bir hata oluştu.\");\n          setMessage({ type: \"error\", text: data.error || \"Bilinmeyen bir hata oluştu.\" });\n        }\n        setLoading(false);\n        // Backend loglarını çek\n        fetch(\"/logs\")\n          .then(res => res.json())\n          .then(logData => {\n            appendLog(\"[BACKEND LOG - Son 50 Satır]\");\n            (logData.lines || []).forEach(line => appendLog(line.trim()));\n          });\n      })\n      .catch((e) => {\n        setError(\"Sunucuya ulaşılamadı.\");\n        setMessage({ type: \"error\", text: \"Sunucuya ulaşılamadı.\" });\n        appendLog(`[ERROR] ${e && e.message ? e.message : e}`);\n        setLoading(false);\n      });\n  };\n\n  return (\n    <div>\n      <h2>Analiz ve Sonuç</h2>\n      <MessageBox type={message.type} message={message.text} onClose={() => setMessage({ ...message, text: \"\" })} />\n      <div style={{background:'#f5f5f5', borderRadius:8, padding:'12px 16px', margin:'12px 0 18px 0', fontSize:14, maxHeight:260, overflowY:'auto'}}>\n        <b>Analiz Günlüğü</b>\n        <pre style={{whiteSpace:'pre-wrap', margin:0}}>{log.join(\"\\n\")}</pre>\n      </div>\n      <button className=\"modern-btn\" onClick={onBack}>Geri Dön</button>\n      <button className=\"modern-btn\" onClick={handleAnalyze} disabled={loading} style={{marginLeft: 8}}>\n        Analiz Et\n      </button>\n      {loading && <div className=\"info-message\">Analiz yapılıyor, lütfen bekleyin...</div>}\n      {error && <div className=\"error-message\">{error}</div>}\n      {sonuc && (\n        <div style={{marginTop: 24}}>\n          <StratejiPerformansOzeti sonuc={sonuc} />\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default Step3AnalizSonuc; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}